<dom-module is="openable-container">
    <style>
        :host ::content [animating] {
            overflow: hidden;
        }
    </style>
    <template>
        <content id="content" select=".content"></content>
    </template>
    <script>
        Polymer({
            is: 'openable-container',

            behaviors: [
                Polymer.NeonAnimationRunnerBehavior
            ],

            properties: {
                'opened': {
                    type: Boolean,
                    observer: '_openedChanged'
                },

                'openAnimation': {
                    type: Object,
                    observer: '_entryChanged'
                },

                'closeAnimation': {
                    type: Object,
                    observer: '_exitChanged'
                }
            },

            listeners: {
                'neon-animation-finish': '_onNeonAnimationFinish'
            },

            get contentElement() {
                return Polymer.dom(this.$.content).getDistributedNodes()[0];
            },

            _openedChanged: function(opened) {
                this.contentElement.setAttribute("animating", true);
                if (opened) {
                    this.removeAttribute("hidden");
                    this.playAnimation("entry");
                } else {
                    this.playAnimation("exit");
                }
            },

            _onNeonAnimationFinish: function() {
                if (!this.opened) {
                    this.setAttribute("hidden", true);
                }
                this.contentElement.removeAttribute("animating");
            },

            _entryChanged: function(entry) {
                if (typeof entry === 'string' || entry instanceof String) {
                    entry = [{type: entry}];
                }
                for (var i = 0, contentElement = this.contentElement; i < entry.length; ++i) {
                    entry[i].node = contentElement;
                }
                this.animationConfig = this.animationConfig || {};
                this.animationConfig.entry = entry;
            },

            _exitChanged: function(exit) {
                if (typeof exit === 'string' || exit instanceof String) {
                    exit = [{type: exit}];
                }
                for (var i = 0, contentElement = this.contentElement; i < exit.length; ++i) {
                    exit[i].node = contentElement;
                }
                this.animationConfig = this.animationConfig || {};
                this.animationConfig.exit = exit;
            }
        });
    </script>
</dom-module>
