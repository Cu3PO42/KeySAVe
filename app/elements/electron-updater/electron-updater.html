<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="../../bower_components/neon-animation/animations/scale-up-animation.html">
<link rel="import" href="../../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../../bower_components/marked-element/marked-element.html">

<dom-module is="electron-updater">
    <link rel="import" type="css" href="../../styles/paper-dialog.css">
    <style>
        .update-btn {
            font-weight: bold;
            color: var(--accent-color);
        }

        .align-left {
            text-align: left;
        }

        marked-element {
            display: block;
        }

        marked-element:not(:last-of-type) {
            border-bottom: 1px solid var(--light-primary-color);
        }

        paper-spinner {
            margin-top: 2em;
        }
    </style>
    <template>
        <paper-dialog id="dialog" entry-animation="scale-up-animation" exit-animation="fade-out-animation" modal>
            <div hidden$="{{updateInProgress}}" class="align-left">
                <div>
                    A new update is available. Do you want to install it now?
                </div>
                <template is="dom-repeat" items="{{changelog}}">
                    <marked-element markdown="{{item}}">
                        <div class="markdown-html"></div>
                    </marked-element>
                </template>
                <div class="buttons">
                    <paper-button dialog-dismiss>Discard</paper-button>
                    <paper-button on-click="update" class="update-btn">Ok</paper-button>
                </div>
            </div>
            <div hidden$="{{not(updateInProgress)}}">
                <div>
                    The update is downloading.
                </div>
                <div>
                    KeySAV<sup>e</sup> will restart after it is installed.
                </div>
                <paper-spinner active="{{updateInProgress}}"></paper-spinner>
            </div>
        </paper-dialog>
    </template>
    <script src="electron-updater.js"></script>
</dom-module>
